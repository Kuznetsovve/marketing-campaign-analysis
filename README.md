# Анализ маркетинговых кампаний

Анализ предпочтений в отношении продуктов, эффективность каналов сбыта и установление профилей клиентов, основанные на их покупательских привычках.

## Файлы

`marketing-campaign-analysis.ipynb` - файл с аналитикой

`marketing_campaign.csv` - датасет

`README.md`

`LICENSE`

## Названия столбцов

`ID` : Уникальный идентификатор каждого клиента.

`Year_Birth` : Год рождения клиента.

`Education` : Уровень образования клиента.

`Marital_Status` : Семейное положение клиента.

`Kidhome` : Количество маленьких детей в домохозяйстве клиента.

`Teenhome` : Количество подростков в домохозяйстве клиента.

`Income` : Годовой доход домохозяйства клиента.

`Recency` : Количество дней с момента последней покупки клиента.

`MntFishProducts` : Сумма, потраченная на рыбные продукты за последние 2 года.

`MntMeatProducts` : Сумма, потраченная на мясные продукты за последние 2 года.

`MntFruits` : Сумма, потраченная на фрукты за последние 2 года.

`MntSweetProducts` : Сумма, потраченная на сладости за последние 2 года.

`MntWines` : Сумма, потраченная на винную продукцию за последние 2 года.

`MntGoldProds` : Сумма, потраченная на товары категории «золото» за последние 2 года.

`NumDealsPurchases` : Количество покупок, совершённых по акциям или со скидкой.

`NumCatalogPurchases` : Количество покупок, сделанных по каталогу (с доставкой по почте/курьером).

`NumStorePurchases` : Количество покупок, совершённых непосредственно в офлайн‑магазинах компании.

`NumWebPurchases` : Количество покупок, совершённых через веб‑сайт компании.

`NumWebVisitsMonth` : Количество посещений веб‑сайта компании за последний месяц.

`AcceptedCmp1` : 1, если клиент принял предложение в первой маркетинговой кампании, 0 — иначе.

`AcceptedCmp2` : 1, если клиент принял предложение во второй маркетинговой кампании, 0 — иначе.

`AcceptedCmp3` : 1, если клиент принял предложение в третьей маркетинговой кампании, 0 — иначе.

`AcceptedCmp4` : 1, если клиент принял предложение в четвёртой маркетинговой кампании, 0 — иначе.

`AcceptedCmp5` : 1, если клиент принял предложение в пятой маркетинговой кампании, 0 — иначе.

`AcceptedCmp6` : 1, если клиент принял предложение в последней маркетинговой кампании, 0 — иначе.

`Complain` : 1, если клиент подавал жалобу за последние 2 года, 0 — иначе.

`Country` : Страна, к которой относится клиент.

## Выполненные шаги

### 1. Подключим необходимые библиотеки:

 **Данные и математика**: numpy, pandas <br>
 **Визуализация**: matplotlib, seaborn, mpl_toolkits.mplot3d <br>
 **Предобработка**: LabelEncoder, StandardScaler <br>
 **Моделирование**: PCA, KMeans, XGBClassifier, train_test_split <br>
 **Оценка**: confusion_matrix, classification_report, roc_auc_score <br>

### 2. Загрузка и первичный анализ данных

Загрузить .csv файл с параметром sep='\t'. Вывести первые 5 строк датасета, информацию по датасету, проверить на пустые значения и удалить их, если они есть.

### 3. Визуализация данных

Вывести графики по 3 группам:

1)  **Количественные**: Образование, семейное положение, наличие детей, наличие подростков
2)  **Распределение**: по году рождения, доходу, общая сумма трат, средняя сумма трат
3)  **Диаграммы**: расходов, покупок и одобрения кампаний.й.

### 4. Предобработка данных

**Цель**: добавить полезную информацию, отформатировать даты и удалить лишние столбцы для более удобного анализа.

**Сводная статистика**: `df.describe().T` показывает ключевые числовые показатели (среднее, мин, макс и т.д.) для всех числовых столбцов.

-   **Обработка дат**: преобразование `Dt_Customer` в формат даты и проверка самых ранних/самых поздних дат присоединения.
-   **Новые признаки**:
    - **Age**: 2021 - Year_Birth.
    - **Total_spent**: Сумма всех расходов на продукцию.
    - **Partner**: 1 если married/together, иначе 0.
    - **Children**: Kids + teens.
    - **Family_size**: Children + partner (если есть) + customer.
    - **Customer_For**: Дней с присоединения (на 2021-12-31).
-   **Очистка**: Удалить `Dt_Customer`, `Z_CostContact`, `Z_Revenue`, `Year_Birth` и `ID`.
-   **Проверка**: Использовать `df.info()` для подтверждения окончательной структуры и типов данных.

### 5. Исследование данных и кодирование

**Цель**: Исследовать взаимосвязи признаков, удалить экстремальные значения и превратить категории в числа.

-   **Pairplot**: Показывает диаграммы рассеяния и распределения для ключевых числовых столбцов (Income, Recency, Customer_For, Age, Total_spent, Family_size) для выявления закономерностей и возможных выбросов.
-   **Удаление выбросов**: Для `Age` и `Income` использовать IQR метод для отбрасывания значений за пределами Q1 - 1.5×IQR или Q3 + 1.5×IQR.
-   **Кодирование категорий**: Применить `LabelEncoder` на `Education` и `Marital_Status` для конвертации текстовых значений в числовые для моделирования.
-   **Проверка**: `df.describe().T` для проверки чистоты данных и новой статистики.

### 6. Корреляционный анализ и масштабирование признаков

**Цель**: проверить взаимосвязи объектов, подготовить данные для группировки или моделирования и масштабировать числовые значения.

-   **Тепловая карта корреляций**: `df.corr()` + `sns.heatmap()` чтобы увидеть, как числовые характеристики соотносятся друг с другом и выявить сильные или избыточные связи.
-   **Подготовка датасета**: Создать копию (`df2`) и удалить целевые столбцы (`AcceptedCmp1--5`, `Complain`, `Response`), чтобы сфокусироваться на описательных признаках.
-   **Группы признаков**: Разделить числовые столбцы (доход, покупки, траты, данные о семье) от категориальных (закодированные `Education`, `Marital_Status`, `Partner`).
-   **Масштабирование**: Использовать `StandardScaler` для стандартизации числовых данных (среднее 0, ст. откл. 1), затем объединить масштабированные числовые данные с категориальными столбцами в `scaled_df`.
-   **Проверка**: `scaled_df.head()` и `scaled_df.shape` подтверждают преобразованный датасет.

### 7. Понижение размерности с помощью PCA

**Цель**: Сократить пространство признаков, сохранив не менее 90% дисперсии данных.

-   **Применение PCA**: Вычислить главные компоненты и проверить, сколько дисперсии объясняет каждая из них.
-   **График локтя**: Показать кумулятивную дисперсию, чтобы найти точку, где сохраняется ≥90% информации.
-   **Выбор компонент**: Выбрать наименьшее количество компонент, удовлетворяющих порогу в 90%.
-   **Преобразование данных**: Применить PCA для создания `pca_df` - сокращенного датасета, готового для кластеризации или моделирования.

### 8. Кластеризация K-Means

**Цель**: Сгруппировать клиентов в содержательные сегменты.

-   **Метод локтя**: Протестировать значения K от 1 до 10 и построить график инерции, чтобы найти "локоть" - точку, где добавление большего количества кластеров дает незначительный выигрыш.
-   **Оптимальное K**: Локоть появился при **K = 3**, что указывает на три группы клиентов.
-   **Финальная модель**: Применить `KMeans(n_clusters=3)` и добавить полученные метки групп в датасет.

### 9. 3D-визуализация кластеров

**Цель**: Увидеть, насколько хорошо 3 кластера разделяются в основных PCA-измерениях.

-   **Проверка дисперсии**: Убедиться, что первые 3 главные компоненты объясняют большую часть дисперсии данных.
-   **3D диаграмма рассеяния**: Построить график `PC1`, `PC2` и `PC3` с точками, окрашенными в соответствии с метками кластеров, для визуальной проверки разделения групп.

### 10. Профилирование кластеров и ключевые инсайты

**Цель**: Понять, чем 3 кластера отличаются по демографии, тратам и вовлеченности.

-   **Размер кластера**: Countplot показывает, сколько клиентов принадлежит к каждой группе.
-   **Доход vs. Траты**: Диаграмма рассеяния показывает, какие кластеры сочетают высокий доход с высокими общими тратами.
-   **Траты на продукты**: Столбчатые диаграммы показывают средние траты по категориям (вино, мясо, сладости и т.д.) для каждого кластера.
-   **Промоакции**: Другая столбчатая диаграмма показывает, как часто каждый кластер покупает по скидкам или акциям.

Эти сравнения превращают сырые кластеры в четкие сегменты клиентов, направляя маркетинговые и продуктовые стратегии.

### 11. Описание групп

Основываясь на паттерне трат и демографическом анализе, опишем 3 группы.
Дополнительно построим графики рассеяния по кластерам и оценим паттерны трат в разных категориях.

### 12. Сравнительный анализ

Демографические данные и данные о расходах по группам (количество детей, подростков, размер семьи, возраст, общие траты). Дополнительно построим графики рассеяния по кластерам, скрипичную диаграмму и оценим демографические данные в разных категориях.
